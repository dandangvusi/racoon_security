<div class="pagetitle">
  <h1>Dashboard</h1>
  <nav>
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="index.html">Home</a></li>
      <li class="breadcrumb-item active">Dashboard</li>
    </ol>
  </nav>
</div><!-- End Page Title -->

<section class="section dashboard">
  <div class="row">
    <!-- Left column -->
    <div class="col-lg-8">
      <div class="row">
        <div class="col-6">
          <div class="card top-selling overflow-auto">

            <div class="card-body pb-0">
              <h5 class="card-title">Alert History</h5>
              <table class="table table-borderless">
                <thead>
                  <tr>
                    <th scope="col">Sensor ID</th>
                    <th scope="col">Time</th>
                    <th scope="col">Delete</th>
                  </tr>
                </thead>
                <tbody>
                  <% alerts.forEach(alert => { %>
                  <tr>
                    <td class="fw-bold"><%= alert.id %></td>
                    <td><%= alert.alert_time %></td>
                    <td>
                      <a href="<%=`/alerts/${alert._id}/delete?_method=DELETE` %>" onclick="confirm('Are you sure you want to delete this record?')">Delete</a>
                    </td>
                  </tr>
                  <% }); %>
                </tbody>
              </table>

            </div>

          </div>
        </div>
        <div class="col-6">
          <div class="card top-selling overflow-auto">

            <div class="card-body pb-0">
              <h5 class="card-title">Sensor Status</h5>
              <table class="table table-borderless">
                <thead>
                  <tr>
                    <th scope="col">Sensor ID</th>
                    <th scope="col">Status</th>
                  </tr>
                </thead>
                <tbody>
                  <% sensors.forEach(sensor => { %>
                  <tr>
                    <td class="fw-bold"><%= sensor.id %></td>
                    <% if(sensor.status == 0){ %>
                      <td>Open</td>
                    <% }else{ %>
                      <td>Closed</td>
                    <% } %>
                  </tr>
                  <% }); %>
                </tbody>
              </table>

            </div>

          </div>
        </div><!-- End Top Selling -->
      </div>
    </div>
    <div class="col-lg-4">
      <div class="card info-card sales-card">
        <div class="card-body">
          <h5 class="card-title">Alert Mode</h5>
          <div class="d-flex align-items-center">
            <div class="card-icon rounded-circle d-flex align-items-center justify-content-center">
              <i class="bi bi-alarm"></i>
            </div>
            <div class="ps-3">
              <% if(modes[0].status == 0){ %>
                <h6>Off</h6>
                <span class="text-muted small pt-2 ps-1">Alert mode is off</span>
              <% }else{ %>
                <h6>On</h6>
                <span class="text-muted small pt-2 ps-1">Alert mode is on</span>
              <% } %>
            </div>
            <div class="ps-5">
              <form action="/mode" method="post">
                <input name="modeStatus" type="hidden" class="form-control" id="modeoff" value="0">
                <button type="submit" class="btn btn-danger">Off</button>
              </form>
            </div>
            <div class="ps-5">
              <form action="/mode" method="post">
                <input name="modeStatus" type="hidden" class="form-control" id="modeon" value="1">
                <button type="submit" class="btn btn-primary">On</button>
              </form>
            </div>
          </div>
        </div>

      </div>
      <div class="card info-card sales-card">
        <div class="card-body">
          <h5 class="card-title">House Status</h5>
          <div class="d-flex align-items-center">
            <div class="card-icon rounded-circle d-flex align-items-center justify-content-center">
              <i class="bi bi-shield-check"></i>
            </div>
            <div class="ps-3">
              <% if(sensors[0].status == 1){ %>
                <h6>Safe</h6>
                <span class="text-muted small pt-2 ps-1">All doors are closed</span>
              <% }else{ %>
                <h6>Not safe</h6>
                <span class="text-muted small pt-2 ps-1">Some doors are open</span>
              <% } %>
            </div>
          </div>
        </div>
      </div>
      <div class="card info-card sales-card">
        <div class="card-body">
          <h5 class="card-title">Buzzer</h5>
          <div class="d-flex align-items-center">
            <div class="card-icon rounded-circle d-flex align-items-center justify-content-center">
              <i class="bi bi-megaphone"></i>
            </div>
            <div class="ps-3">
              <% if(buzzers[0].status == 0){ %>
                <h6>Off</h6>
                <span class="text-muted small pt-2 ps-1">Buzzers are off</span>
              <% }else{ %>
                <h6>On</h6>
                <span class="text-muted small pt-2 ps-1">Buzzers are on</span>
              <% } %>
            </div>
            <div class="ps-5">
              <form action="/buzzers" method="post">
                <input name="buzzerStatus" type="hidden" class="form-control" id="buzzeroff" value="0">
                <button type="submit" class="btn btn-danger">Off</button>
              </form>
            </div>
            <div class="ps-5">
              <form action="/buzzers" method="post">
                <input name="buzzerStatus" type="hidden" class="form-control" id="buzzeron" value="1">
                <button type="submit" class="btn btn-primary">On</button>
              </form>
            </div>
          </div>
        </div>
      </div>
      <div class="card info-card sales-card">
        <div class="card-body">
          <h5 class="card-title">LED Light</h5>
          <div class="d-flex align-items-center">
            <div class="card-icon rounded-circle d-flex align-items-center justify-content-center">
              <i class="bi bi-lightbulb"></i>
            </div>
            <div class="ps-3">
              <% if(leds[0].status == 0){ %>
                <h6>Off</h6>
              <span class="text-muted small pt-2 ps-1">LED lights are off</span>
              <% }else{ %>
                <h6>On</h6>
              <span class="text-muted small pt-2 ps-1">LED lights are on</span>
              <% } %>
            </div>
            <div class="ps-5">
              <form action="/leds" method="post">
                <input name="ledStatus" type="hidden" class="form-control" id="ledoff" value="0">
                <button type="submit" class="btn btn-danger">Off</button>
              </form>
            </div>
            <div class="ps-5">
              <form action="/leds" method="post">
                <input name="ledStatus" type="hidden" class="form-control" id="ledon" value="1">
                <button type="submit" class="btn btn-primary">On</button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>